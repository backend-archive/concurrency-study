CREATE TABLE IF NOT EXISTS `NEWBIE_CANDIDATE` (
  `USER_NO` BIGINT NOT NULL COMMENT '후보 회원 번호',
  `GENDER` CHAR(1) NOT NULL COMMENT '성별',
  `STATUS` VARCHAR(45) NOT NULL COMMENT '상태',
  `PROFILE_LABEL` VARCHAR(255) DEFAULT NULL COMMENT '표시용 프로필 라벨',
  `PHOTO_URLS` TEXT COMMENT '쉼표 구분 사진 URL 목록',
  `REG_DATE` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시',
  `UP_DATE` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정 일시',
  PRIMARY KEY (`USER_NO`),
  KEY `IDX_NEWBIE_CANDIDATE_STATUS` (`STATUS`, `GENDER`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='뉴비 평가 후보';

CREATE TABLE IF NOT EXISTS `NEWBIE_EVAL_HIST` (
  `EVAL_NO` BIGINT NOT NULL AUTO_INCREMENT COMMENT '평가 번호',
  `EVAL_USER_NO` BIGINT NOT NULL COMMENT '평가자 회원 번호',
  `NEWBIE_USER_NO` BIGINT NOT NULL COMMENT '피평가자 회원 번호',
  `PROFILE_LABEL` VARCHAR(255) DEFAULT NULL COMMENT '응답용 프로필 라벨 스냅샷',
  `PHOTO_URLS` TEXT COMMENT '응답용 사진 URL 스냅샷',
  `SCORE` INT NOT NULL DEFAULT 0 COMMENT '평가 점수',
  `EVAL_DATE` DATETIME DEFAULT NULL COMMENT '평가 일시',
  `END_YN` TINYINT(1) NOT NULL DEFAULT 0 COMMENT '평가 종료 여부',
  `REG_DATE` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP COMMENT '등록 일시',
  `UP_DATE` DATETIME NOT NULL DEFAULT CURRENT_TIMESTAMP ON UPDATE CURRENT_TIMESTAMP COMMENT '수정 일시',
  PRIMARY KEY (`EVAL_NO`),
  KEY `IDX_NEWBIE_EVAL_PENDING` (`EVAL_USER_NO`, `END_YN`, `SCORE`),
  KEY `IDX_NEWBIE_EVAL_COUNT` (`EVAL_USER_NO`, `EVAL_DATE`, `SCORE`),
  KEY `IDX_NEWBIE_EVAL_NEWBIE` (`NEWBIE_USER_NO`, `SCORE`)
) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_unicode_ci COMMENT='신규 가입자 평가 이력';

INSERT INTO `NEWBIE_CANDIDATE` (`USER_NO`, `GENDER`, `STATUS`, `PROFILE_LABEL`, `PHOTO_URLS`)
VALUES
  (2001, 'W', 'PHOTO_EVAL', '28 | BUSAN | Developer', 'https://example.com/newbie-2001-1-ready.jpg,https://example.com/newbie-2001-2-ready.jpg'),
  (2002, 'W', 'PHOTO_EVAL', '27 | DAEGU | Designer', 'https://example.com/newbie-2002-1-ready.jpg')
ON DUPLICATE KEY UPDATE
  `GENDER` = VALUES(`GENDER`),
  `STATUS` = VALUES(`STATUS`),
  `PROFILE_LABEL` = VALUES(`PROFILE_LABEL`),
  `PHOTO_URLS` = VALUES(`PHOTO_URLS`);
